<!--"<style>
    .content-tree-item {
        width: calc(100% - 25px);
        padding-left: 25px;
        position: relative;
        cursor: pointer;
        border-top: dashed 1px #eee;
        padding-top:5px;
        height: 25px;
        overflow: hidden;
    }

    .content-tree-arrow {
        position: absolute;
        left: 0;
        top: 7px;
        width: 15px;
        height: 15px;
    }

    .active.content-tree-item{
        height:auto;
    }

    .active > .content-tree-arrow {
        transform: rotate(90deg);
    }
</style>

<div>
	<h2>UCM - Umbraco Content Merger tool</h2>

	<form name="treeSelector">
		<p>Please select the items you would like to export:</p>
		<div id="tree-view">
		</div>
	</form>
</div>

<script>
	

    (function () {
	    //get all the content tree
	    makeRequest('GetContentTree', null, function (data) {
	        function drawItem(item, level, parent) {
	            var element = $(document.createElement('div'));
	            element.attr('class', 'content-tree-item');

	            parent.append(element);

				var levelString = '';
	            /*for(var i = 0; i < level; i++){
					levelString += ' - ';
				}*/

				if (item.Children.length > 0) {
				    element.append('<div class="content-tree-arrow">&gt;<div>');
				}

				element.append(levelString + '<label><input type="checkbox" name="' + item.Name + '" value="" item-id="' + item.Id + '"> ' + item.Name + '</label><br/>');

				for(var i = 0; i < item.Children.length; i++){
				    drawItem(item.Children[i], level + 1, element);
				}
			}
			
			for(var i = 0; i < data.length; i++){
			    drawItem(data[i], 0, $('#tree-view'));
			}

			$('.content-tree-arrow').on('click', function (e) {
			    $(this).parent().toggleClass('active');
			});
	    });
	})();
</script>
    -->

<h3>Umbraco Content Merger tool</h3>
<h5>UCM - v0.1</h5>
<hr />
<div class="ucm-content-holder">
    <p class="ucm-progress-label"></p>
    <div class="export-content-btn">Export all content</div>
    <!--<p class="images-checker"><label><input type="checkbox" checked="checked" class="export-images-check"/> Export all used images</label></p>-->
</div>

<script>
    function makeRequest(action, data, callback) {
        var url = '/Umbraco/backoffice/Api/UCM/' + action;
        $.post({
            url: url,
            dataType: 'json',
            data: data
        })
		.fail(function (e) {
		    alert('request failed for url: ' + url);
		    console.log(e);
		})
		.done(callback);
    }

    $(document).ready(function () {
        $('div.export-content-btn').on('click', function () {
            var btn = $(this);
            btn.addClass('disabled');
            var label = $('p.ucm-progress-label');
            label.text('Compiling and exporting package... (might take several minutes)');
            makeRequest('ExportAll', null, function (data) {
                label.text('Export finished');
                btn.removeClass('disabled');
            });
        });
    });
</script>

<style>
    div.ucm-content-holder{
        /*text-align: center;*/
    }

    p.images-checker label{
        font-size: 10px;
        margin-left: 18px;
    }

    div.export-content-btn{
        cursor: pointer;
        padding: 30px;
        background-color: #413659;
        color: #fff;
        border: 1px solid #2e2246;
        display: inline-block;
        width: auto;
        margin: 15px;
    }

    div.export-content-btn:hover{
        background-color: #7A5ABA;
    }

    div.export-content-btn.disabled{
        cursor:default;
        background-color: #6D647F;
    }
</style>